<!DOCTYPE html>

<html>
    <head>
        <title>Documentation API refuges.info</title>
        <meta charset=utf-8 />
        <link rel="stylesheet" type="text/css" media="all" href="style.css" />
        <script type="text/javascript">
            function isValidEmail(str) {
                return (str.indexOf(".") > 2) && (str.indexOf("@") > 0);
            }
            
            function ValidateForm(form)
            {
                if(!isValidEmail(form.mail.value)) 
                { 
                    alert('L\'adresse courriel entrée est invalide') 
                    form.mail.focus(); 
                    return false; 
                }
                return true;
            }
        </script>
    </head>
    
    <body>
        <header>
            <p>API Refuges<span class="small">.info</span></p>
            
            <form method="post" action="addMail.php" onsubmit="javascript:return ValidateForm(this)">
                <input type="text" name="mail" onFocus="if(this.value=='Newsletter API')this.value=''" onblur="if(this.value=='')this.value='Newsletter API'" value="Newsletter API" /><input type="submit" value="Ok!" />
            </form>
        </header>
        
        <section id="intro">
            <h1>Introduction à l'API</h1>
            <p>
                <a href="http://www.refuges.info">Refuges.info</a>
                est un service web personnel et non commercial permettant de se renseigner sur les hébergements de montagnes destinés aux randonneurs.
                Ce service est collaboratif et les informations sur les refuges (coordonnées, commentaires et discussions) ont été renseignées par
                l'ensemble des utilisateur du service.
            </p>
            <p>
                L'<b>API Refuges</b> permet de recevoir dans de nombreux formats une liste de points, des informations détaillées sur un point
                ou encore les résultats de requêtes spéciales telles que la recherche de points ou les nouvelles contributions.
                L'API est disponible en <b>lecture seule</b> uniquement, et aucune autentification ou clé d'API n'est requise.
            </p>
            <p>
                Nous vous invitons à vous abonner à la newsletter de l'API (en haut à droite) de manière à être informé des évolutions qui pourraient apparaître et afin de nous aider
                à établir des statistiques d'utilisations de l'API. <i>Note : Les mails sont stockés sur notre serveur mais ne seront en aucun cas partagés à des tiers. En vous abonnant vous acceptez
                tout de même de recevoir un mail de notre part, ce qui ne va pas arriver souvent ;).</i>
            </p>
            <p>
                Les données du site Refuges.info sous sont licence <a href="http://creativecommons.org/licenses/by-sa/2.0/deed.fr">CC By-Sa 2.0</a>, cependant l'API permet aussi de retourner des données
                provenant d'OpenStreetMap via sa fonction de recherche, ces données sont sous licence <a href="http://opendatacommons.org/licenses/odbl/">ODbL</a>.
                Plus d'informations sur <a href="http://www.refuges.info/wiki/licence/">la licence des contenus</a>,
                <a href="http://www.openstreetmap.org/copyright">la licence d'OpenStreetMap</a>,
                et <a href="https://github.com/sletuffe/www.refuges.info">le code source du site</a> ou vous pouvez contribuer avec plaisir.
            </p>
        </section>
        
        <section id="sommaire">
            <h1>Sommaire de l'API</h1>
            
            <h2>Export d'une liste de points</h2>
            <ul>
                <li><a href="#/api/bbox"><span class="methode">GET</span> <span class="url">/api/bbox</span></a> &mdash; <span class="description">Export des points contenus dans une bbox</span></li>
                <li><a href="#/api/massif"><span class="methode">GET</span> <span class="url">/api/massif</span></a> &mdash; <span class="description">Export des points contenus dans un massif</span></li>
            </ul>

            <h2>Informations détaillées sur un point</h2>
            <ul>
                <li><a href="#/api/point"><span class="methode">GET</span> <span class="url">/api/point</span></a> &mdash; <span class="description">Export des informations détaillées sur un point</span></li>
            </ul>

            <h2>Requêtes à la base de donnée</h2>
            <ul>
                <li><a href="#/api/recherche"><span class="methode">GET</span> <span class="url">/api/recherche</span></a> &mdash; <span class="description">Recherche d'un point de la base de données</span></li>
                <li><a href="#/api/contributions"><span class="methode">GET</span> <span class="url">/api/contributions</span></a> &mdash; <span class="description">Export de la liste des dernières contributions</span></li>
            </ul>
        </section>
        
        <section>
            <h1>Export d'une liste de points</h1>
            
            <h2 id="/api/bbox">Sélection de la zone via une bbox</h2>
            <p>
                En cours de développement
            </p>
            
            <h2 id="/api/massif">Sélection de la zone via des massifs</h2>
            <p>
                En cours de développement
            </p>
        </section>

        <section>
            <h1 id="/api/point">Informations détaillées sur un point</h1>
            <p>
                La requête <a href="#/api/point"><span class="methode">GET</span><span class="url">/api/point</span></a> permet de retourner les informations détaillées d'un point
                de la base de donnée à partir de son <b>ID</b>. Les paramètres sont définis
                dans le tableau suivant, et vous trouverez au dessous des exemples de structuration des réponses.
                <table>
                    <tr><th>Paramètre</th><th>Description</th><th>Valeur par défaut</th><th>Exemples</th></tr>
                    <tr>
                        <td>id</td>
                        <td><span class="req">Requis</span> L'id du point dont on veut des informations</td>
                        <td>Aucune</td>
                        <td><span class="url">2536</span>...</td>
                    </tr>
                    <tr>
                        <td>format</td>
                        <td><span class="opt">Optionnel</span> Le format de l'export.</td>
                        <td><span class="url">json</span></td>
                        <td><span class="url">json</span>, <span class="url">xml</span><!--, <span class="url">pdf</span>--></td>
                    </tr>
                    <tr>
                        <td>format_texte</td>
                        <td><span class="opt">Optionnel</span> Le formatage du texte, que vous devrez retravailler par la suite.<!-- Incompatible avec l'export au <b>format</b> pdf.--></td>
                        <td><span class="url">bbcode</span></td>
                        <td><span class="url">bbcode</span>, <span class="url">texte</span>, <span class="url">markdown</span>, <span class="url">html</span></td>
                    </tr>
                    <tr>
                        <td>nb_coms</td>
                        <td><span class="opt">Optionnel</span> Nombre de commentaires maximum à retourner. Retourne aucun commentaire pour <span class="url">0</span>. Retourne les n commentaires les plus récents.</td>
                        <td><span class="url">5</span></td>
                        <td><span class="url">18</span>...</td>
                    </tr>
                    <tr>
                        <td>nb_points_proches</td>
                        <td><span class="opt">Optionnel</span> Nombre de points proches à retourner. Retourne les n points les plus proches, dans un rayon de 5 km autour du point.</td>
                        <td><span class="url">3</span></td>
                        <td><span class="url">6</span>...</td>
                    </tr>
<!--                    <tr>
                        <td>fond_carto</td>
                        <td><span class="opt">Optionnel</span> Sélection du fond de carte à adopter pour l'export quand le <b>format</b> est pdf. Cette liste est dans un premier temps limités à des fonds libres de droits.</td>
                        <td><span class="url">mri</span></td>
                        <td><span class="url">mri</span>, <span class="url">outdoor_tf</span>, <span class="url">osm_fr</span></td>
                    </tr>
-->                </table>
            </p>
        </section>
                
        <section>
            <h1>Requêtes à la base de donnée</h1>
            
            <h2 id="/api/recherche">Recherche dans la base de données</h2>
            <p>
                En cours de développement
            </p>
            <h2 id="/api/contributions">Dernières contributions</h2>
            <p>
                En cours de développement
            </p>
        </section>
        
        <footer></footer>
    </body>
</html>
