<?// Bloc affiché sur la page de recherche

// Ce fichier est l'unique endroit ou peuvent se trouver des balises HTML
// Un couple <ouverture de balise> </fermeture de balise> doit se trouver dans le même fichier et avec la même indentation
// Ce fichier ne contient que des balises HTML et des balises de contrôle PHP
// $modele contient les données passées par le fichier PHP
// $config les données communes à tout WRI

// 17/10/11 Dominique : Création
// 15/02/13 jmb : legere modifs "info_base"
?>
<script>
	function toggle_hidden(el_name) {
	
		switch ( document.getElementsByName(el_name)[0].value ) {
			case "" :
				//document.getElementById(el_name).readonly = true ;
				//document.getElementById(el_name).style.visibility = "visible";
				document.getElementById(el_name).style.outline = "medium ridge";
				document.getElementsByName(el_name)[0].value = "oui" ;
				document.getElementById(el_name).checked = true ;
				break ;
			case "oui" :
				document.getElementsByName(el_name)[0].value = "non" ;
				document.getElementById(el_name).checked = false ;
				break ;
			case "non" :
				document.getElementsByName(el_name)[0].value = "" ;
				//document.getElementById(el_name).style.background = "#ddd";
				document.getElementById(el_name).checked = false ;
				document.getElementById(el_name).style.outline = "" ;
				//document.getElementById(el_name).disabled = true ;
				//document.getElementById(el_name).style.visibility = "hidden";
				//document.getElementById(el_name).style.outline = "hidden";
				//document.getElementById(el_name).parentNode.replaceChild(document.createElement("span"), document.getElementById(el_name));
				break ;
		}
//		document.getElementsByName(el_name)
//		console.log(document.getElementsByName(el_name)[0].value);
//		el_name.checked = true;
	}
</script>
<div class="contenu">
	<!-- =========================== -->
	<h3><?=$modele->titre?></h3>
	<h4>Rechercher sur ce site</h4>

	<!-- =========================== -->
	<form method="post" action="./point_recherche.php">
		<!-- =========================== -->
		<fieldset>
			<legend>Nom</legend>
			<input type="text" name="nom" title="tout ou partie du nom, par exemple 'jasse' ou 'la pra'" />
			<!-- =========================== -->
			<select name="id_point_type" title="type d'hébergement, gîte, cabane ...">
				<option value="">(tous)</option>
				<option value="tout-refuge" selected="selected">Tout type de refuge</option>
				<?php if (is_array($modele->infos_base->types_point)) 
					foreach ($modele->infos_base->types_point AS $t) {?>
						<option value="<?=$t->id_point_type?>"><?=$t->nom_type?></option>
					<?}?>
			</select>
		</fieldset>
		<!-- =========================== -->
		<fieldset>
			<legend>Localisation</legend>
			<p>Massif: 
				<select name="id_massif" title="Massif ou Zone contenant l'hébergement">
					<option value="">(partout)</option>
					<?php
						// Ca se complique avec les zones.
						// pour chaque zone, on fait un OPTGROUP, et dedans on reparcours les massifs.
						
						foreach ($modele->zones as $z) { ?>
							<optgroup label="<?=$z->nom_polygone?>">
							<option value="<?=$z->id_polygone?>">(toute la région <?=$z->nom_polygone?>)</option>
							<?php 
							foreach ($modele->massifs AS $m) 
								if( $m->id_zone == $z->id_polygone ) { ?>
									<option value="<?=$m->id_polygone?>"><?=$m->nom_polygone?></option> <?php
								} 
							?></optgroup><?php
						}
					?>
				</select>
			</p>
			<!-- =========================== -->
			<p>
				Altitude entre :
				<input type="text" name="altitude_minimum" maxlength="4" size="4" title="Altitude minimum" />
				m et 
				<input type="text" name="altitude_maximum" maxlength="4" size="4" title="Altitude maximum" />m
			</p>
			<!-- =========================== -->
			<p>
				Précision des coordonnéés GPS :
				<select name="precision_gps" title="Un positionnement précis est-il indispensable ?">
					<option value="">(Peu importe)</option>
					<option value="1,2">Prises sur une carte ou le terrain</option>
					<?foreach ($modele->infos_base->type_precision AS $p) {?>
						<option value="<?=$p->id_type_precision_gps?>"><?=$p->nom_precision_gps?></option>
					<?}?>
				</select>
			</p>
			<!-- =========================== -->
			<p>
				Coordonnées GPS (WGS84) :
				<label>Latitude:<input type="text" name="lat" maxlength="10" size="8" /></label>
				<label>Longitude:<input type="text" name="lon" maxlength="10" size="8" /></label>
				<label>dans un rayon de<input type="text" name="autour" maxlength="6" size="4" value="1000" /></label>mètres autour
			</p>
		</fieldset>
		<!-- =========================== -->
		<fieldset>
			<legend>Confort</legend>
			<label>Couvertures<input type="checkbox" id="couvertures" onClick="toggle_hidden('couvertures');" /><input type="hidden" name="couvertures" value="" /></label>
			<label>Eau à proximité<input type="checkbox" id="eau_a_proximite" onClick="toggle_hidden('eau_a_proximite');" /><input type="hidden" name="eau_a_proximite" value="" /></label>
			<label>Bois à proximité<input type="checkbox" id="bois_a_proximite" onClick="toggle_hidden('bois_a_proximite');" /><input type="hidden" name="bois_a_proximite" value="" /></label>
			<label>Latrines<input type="checkbox" id="latrines" onClick="toggle_hidden('latrines');" /><input type="hidden" name="latrines" value="" /></label>
			<label>Abri sommaire:<input type="checkbox" id="sommaire" onClick="toggle_hidden('sommaire');" /><input type="hidden" name="sommaire" value="" /></label>
		<!-- =========================== -->
			<p>
				Nombre de places compris entre&nbsp;:
				<input type="text" name="places_minimum" maxlength="3" size="3" />
				et
				<input type="text" name="places_maximum" maxlength="3" size="3" />
			</p>
			<!-- =========================== -->
			<p>
				Moyen de chauffage :
				<label>Poële ou cheminée:<input type="radio" name="chauffage" value="chauffage" /></label>
				<label>Cheminée:<input type="radio" name="chauffage" value="cheminee" /></label>
				<label>Poële:<input type="radio" name="chauffage" value="poele" /></label>
				<label>Non renseigné:<input type="radio" name="chauffage" value="" checked="checked" /></label>
			</p>
			<!-- =========================== -->
			<p>
				Le champ remarques contient: 
				<input type="text" name="description" title="exemple: scie, table ..." />
			</p>
		</fieldset>

		<fieldset>
			<legend>Attributs divers</legend>
			<label>Utilisable<input type="checkbox" id="ouvert" onClick="toggle_hidden('ouvert');" checked="checked" /><input type="hidden" name="ouvert" value="oui" /></label>
			<label>Clef à récupérer<input type="checkbox" id="clef_a_recuperer" onClick="toggle_hidden('clef_a_recuperer');" /><input type="hidden" name="clef_a_recuperer" value="" /></label>
		</fieldset>

		<!-- =========================== -->
		<fieldset>
			<legend>Résultats</legend>
			<label title="Si cette case est cochée, la recherche se limitera aux X premiers résultats">Limiter le nombre de résultat aux <?=$config['points_maximum_recherche']?> premiers
				<input type="checkbox" name="limite" value="1" checked="checked" /></label>
			<!-- =========================== -->
			<p>
				<input type="submit" name="recherche" value="chercher!" />
			</p>
			<!--<input type="submit" name="carte" value="Afficher sur une carte (non fonctionnel)" />-->
			<!-- =========================== -->
		</fieldset>
	</form> 
	<!-- =========================== -->
	<h4>Rechercher dans les Pyrénées ?</h4>
	<p>
		Compléter votre recherche avec l'excellent site 
		<a href="http://www.pyrenees-refuges.com">www.pyrenees-refuges.com</a>
	</p>
	<!-- =========================== -->
</div>
